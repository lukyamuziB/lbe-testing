machine:
  php:
    version: 7.0.7
  environment:
    APP_ENV: testing
    POSTGRES_USER: ubuntu
    POSTGRES_HOST: "127.0.0.1"
    POSTGRES_DB: lenken-test
    COVERALLS_SERVICE_NAME: circle-ci
    PROJECT_NAME: microservices-kube
    CLUSTER_NAME: staging
    CLOUDSDK_COMPUTE_ZONE: us-east1-c
    CONTAINER_NAME: lenken-server
    DEPLOYMENT: lenken-server
    IMAGE: lenken-server
    PROJECT_NAME_PROD: andela-kube
    CLUSTER_NAME_PROD: andela-prod
    CLOUDSDK_COMPUTE_ZONE_PROD: us-east1-b
    CONTAINER_NAME_PROD: lenken-server
    DEPLOYMENT_PROD: lenken-server
    IMAGE_PROD: lenken-server
    IMG_TAG: $(echo $CIRCLE_SHA1 | cut -c -7)
  services:
    - redis

general:
  artifacts:
    - "reports"

dependencies:
  override:
    - curl -sS https://getcomposer.org/installer | php --filename=composer
    - composer install --prefer-dist --no-interaction

test:
  override:
    - composer test

#deployment:
#  staging:
#    branch: develop
#    heroku:
#      appname: lenken-api-staging